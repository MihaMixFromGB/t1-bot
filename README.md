# Проект: T1 Bot

![React](https://img.shields.io/badge/react-%2320232a.svg?style=for-the-badge&logo=react&logoColor=%2361DAFB)
![Vite](https://img.shields.io/badge/vite-%23646CFF.svg?style=for-the-badge&logo=vite&logoColor=white)

## Структура проекта

`Bot`: папка, со скриптами для ботов.

- `Bot/index.js` содержит реализацию интерфейса для работы с ботом - метод `request(message: string): string`. Здесь выполняется импорт ботов с координацией их работы при необходимости.
- `Bot/terminal.mjs` запускает cli для работы с ботом (на вход принимает текстовую строку и в
  зависимости от этой текстовой строки выполняет определенные действия).
- `Bot/DepositService` проект бота для работы с депозитами. Интерфейс взаимодействия с ботом содержит один метод `request(message: string): string`.
- `Bot/DepositService/index.js` содержит реализацию интерфейса взаимодействия с ботом, а также методы для определения и выполнения запросов пользователя.
- `Bot/DepositService/Conversation.js` содержит описание сценария работы бота. Сценарий описывается в форме структуры связанного списка, где каждый элемент содержит два свойства - `action` (действие, которое требуется выполнить), `next` (ссылка на список действий следующего шага по сценарию). Для управления сценарием реализован метод `next(action?: Action): Action[]`. Если в метод ничего не передается, то возвращается текущий список разрешенных действий. Если передается действие, то выполняется переход на следующий шаг и возвращается обновленный список разрешенных действий. Если найденное действие не содержит свойства `next`, то происходит возврат к первому шагу сценария.
- `Bot/DepositService/types` содержит описание типов, используемых в проекте (типов запросов).
- `Bot/DepositService/template` содержит описание шаблонов для определения запросов пользователя, а также шаблонов ответов бота.
- `Bot/DepositService/api` содержит описание API бота для взаимодействия с внешними сервисами (справочник вкладов `DepositService`, предполагаемый AI-сервис `BotService` для определения типов запросов пользователя (сейчас определение запросов выполнено локально)). Для взаимодействия с `BotService` предложен интерфейс `{result: boolean, payload: string | Object}`, содержащий результат проверки запроса пользователя на соответствие разрешенному запросу и дополнительные сведения необходимые для выполнения запроса. `mock` содержит моковые данные для тестирования бота, `translaters` - методы-адаптеры для сопряжения интерфейсов внешних сервисов с интерфейсом бота, `utils` - вспомогательные методы для проверки соответсвия запросов пользователя разрешенным действиям на основе регулярных выражений и заранее заданных шаблонов распознования.

Остальные файлы в папке `src` содержат упрощенное приложение (чат) для проверки работы бота.

## Описание алгоритма работы бота

После получения сообщения пользователя выполняется запрос разрешенных действий для текущего шага сценария. В цикле для списка разрешенных действий выполняется проверка соответствия запроса пользователя разрешенным действиям. При первом совпадении цикл прерывается и происходит выполнения действия. Результат выполнения - текстовое сообщение пользователю. При отсутствии совпадения или возникновении ошибок в результате выполнения запроса выдаются соответствующие сообщения.

> [!IMPORTANT]
> Для повышения UX в дополнение к требованиям ТЗ были добавлены два шаблона ответов (ошибка при выполнении запроса списка вкладов и отсутствие запрошенного вклада в списке доступных).

## Консольное демо приложение

Скрипт на языке JS, который на вход принимает текстовую строку и в зависимости от этой текстовой строки выполняет определенные действия. Для запуска выполните следующие действия (проверено на Node v.20.10.0):

```
git clone https://github.com/MihaMixFromGB/t1-bot.git
cd t1-bot
npm run terminal
```

## Демо приложение

Для демонстрации работы бота разработана упрощенная версия чата.

Интернет-версия - https://t1-bot.vercel.app/.

Для локального запуска проекта выполните следующие действия:

```
git clone https://github.com/MihaMixFromGB/t1-bot.git
cd t1-bot
npm ci
npm run dev
```

После запуска приложения в консоле появится ссылка.
